<html>

<head>
    <link rel="stylesheet" href="/source/css/p/p5.css">
    <title>Установка Windows ADK</title>
</head>

<body>

    <div class="grid"></div>

    <h1>Установка Windows ADK</h1>
    <h2>Цель: Подготовить образ и среду предустановки Windows ADK</h2>
    <h3>Задание:
        <br><br>
        1. Установить программу для виртуализации VirtualBox.
        <br>
        2. Установить на виртуальную машину Windows ADK
    </h3>
    <h4>Выполнение работы:
        <br><br>
        Установим на наш компьютер виртуальную машину VirtualBox. Уверяю вас,
        способ с виртуальной машиной самый простой и использовать его для создания
        собственной сборки Windows сможет даже начинающий пользователь. Уверен, у большей
        части наших читателей она давно установлена. Ещё нам пригодиться USB-флешка
        объёмом не менее 8 Гб.
        В VirtualBox создаём виртуальную машину Windows 10.
        <br><br>
        Загружаем виртуальную машину с ISO-образа Windows 10 и как обычно
        устанавливаем ОС на виртуалку.
        <br>
        В конечной фазе установки ОС, жмём клавиатурное сочетание Ctrl+Shift+F3.
        <br>
        Операционная система переходит в режим аудита.
        <br>
        Можете нажать на крестик и закрыть данное окно (после установки всех
        необходимых программ мы откроем его снова). В режиме аудита вы можете
        устанавливать и удалять программы, перезагружаться и завершать работу компьютера,
        одним словом экспериментируйте с Windows как хотите.
        <br>
        Устанавливаем все те программы, которые мы хотим иметь в дистрибутиве Win 10.
    </h4>
    <h5>Программы устанавливаем, но не запускаем, нужно чтобы они не прописались в
        папке Appdata, которой не будет после sysprep.
        После установки софта запускаем командную строку от имени администратора и
        вводим команду:
        C:\Windows\System32\Sysprep\Sysprep.exe
        <br><br>
        Запускается утилита "sysprep"
        В появившемся окне с параметрами выставляем всё так, как на скришноте
        Перевод системы в режим (OOBE).
        Отмечаем пункт - Подготовка к использованию.
        Завершение работы
        и нажимаем ОК.
        <br><br>
        Windows 10 подготавливается утилитой "sysprep" несколько минут и затем
        виртуальная машина выключается.
        <br><br>
        Опять загружаем виртуальную машину с ISO-образа Windows 10.
        В начальном окне установки Windows 10 жмём клавиатурное сочетание
        «Shift+F10»,
        <br>
        открывается командная строка Среды предустановки Windows PE.
        <br>
        На данном этапе подсоедините USB-флешку к вашему компьютеру.
    </h5>
    <h6>Затем подключите USB-флешку к виртуальной машине. Устройства-
        >USB выберите свою флешку.
        <br><br>
        в командной строке вводим команды:
        diskpart
        lis vol (данной командой выводим список разделов жёсткого диска, видим, что
        разделу с установленной Windows 10 присвоена буква диска C:, а USB-флешке буква (F:).
        exit (выходим из DiskPart)
        вводим следующую команду, которая произведёт захват диска (C:) с
        установленной Windows 10 в файл-образ формата ESD и сохранит его на USB-флешке
        (буква диска (F:).
        <br><br>
        Dism /Capture-Image /ImageFile:F:\install.esd /CaptureDir:C:\ /Name:Windows
        /compress:max
        <br>
        где,
        install.esd: — это название будущего ESD-образа диска (C:) с Windows 10.
        <br>
        F:\ — место сохранения ESD-образа.
        <br>
        C:\ — раздел с установленной Windows 10.
        <br>
        сжатие /compress:maximum (максимальное сжатие)
        <br><br>
        Выключаем виртуальную машину.
        Создание дистрибутива Windows 10
        В итоге всех вышеприведённых манипуляций мы имеем на нашей флешке файл
        install.esd (размер 4.11 Гб), содержащий файлы операционной системы Windows 10 с
        предустановленным программным обеспечением и следующим шагом нам нужно собрать
        на основе его дистрибутив Win 10.
        Виртуальную машину мы выключили и теперь в основной операционной системе
        наша флешка имеет букву диска (K:). На флешке находится файл install.esd размером 4.11
        Гб.
        <br><br>
        Compress:recovery
        Ещё больше сожмём файл-образ Windows 10 - install.esd командой (делать это
        необязательно, просто я хочу дополнительно уменьшить образ Win 10)
        Dism /Export-Image /SourceImageFile:K:\install.esd /SourceIndex:1
        /DestinationImageFile:K:\install2.esd /Compress:recovery
        где K:, это буква нашей флешки с файлом install.esd. То есть, этой командой мы
        создаём ещё один файл этого образа с именем файла install2.esd и сжатием recovery. Или
        умными словами - конвертируем файл install.esd в новый файл install2.esd,
        применив новый тип сжатия Compress:recovery (сжатие архива обычно называют
        конвертированием).
    </h6>
    <h7>Теперь на флешке (K:) появляется второй файл-образ Windows 10 - install2.esd
        размером 3,1 Гб. Первый файл install.esd 4,11 Гб удаляем, а второй файл install2.esd 3,1 Гб
        переименовываем в install.esd. Итого, на переносном винчестере USB (диск K:) находится
        один файл install.esd размером 3,1 Гб.
        <br><br>
        Собираем ISO-образ Windows 10 с новым файлом install.esd
        Скачиваем ISO-образ Windows 10
        <br>
        открываем его (подсоединяем к виртуальному дисководу) и копируем его
        содержимое.
        <br>
        Затем создаём папку на флешке (K:) и называем её 10.
        <br>
        Вставляем в неё скопированное содержимое ISO-образа Windows 10.
        <br>
        После того, как файлы cкопировались, заходим на диск (K:) и копируем файл
        install.esd.
        <br>
        Заходим в папку K:\10\sources, щёлкаем правой мышью и выбираем Вставить.
        Выбираем Заменить файл в папке назначения.
        <br>
        Оригинальный файл install.esd из дистрибутива Windows 10 заменён нашим файлом
        install.esd, содержащим программное обеспечение.
        <br>
        Комплект средств для развертывания Windows (Windows ADK)
        <br>
        Нам осталось превратить папку 10 с файлами Windows 10 в установочный ISO-
        дистрибутив с предустановленным программным обеспечением.
        <br>
        Если Вы опытный пользователь, то наверняка на вашем компьютере установлен
        Комплект средств для развертывания Windows (Windows ADK), если нет, то скачайте его
        по ссылке и установите.
        Для Windows 8.1
        <br>
        https://www.microsoft.com/ru-ru/download/details.aspx?id=39982
        Для Windows 10
        <br>
        https://developer.microsoft.com/ru-ru/windows/hardware/windows-assessment-
        deployment-kit
        <br>
        После установки запускаем среду средств развёртывания и работы с образами.
        <br>
        вводим команду:
        <br>
        Oscdimg /u2 /m
        <br>
        /bootdata:2#p0,e,bK:\10\boot\Etfsboot.com#pef,e,bK:<br>
        \10\efi\microsoft<br>
        \boot\Efisys.bin K:\10
        K:\Windows.iso <br>
        где:
        u2, это файловая система UDF, а m - размер образа без ограничений.
        <br>
        b - загрузочный сектор записать etfsboot.com, путь к файлу etfsboot.com при
        указании b(boot) пишется без пробела bI:\10\boot\etfsboot.com
        <br>
        bK: - где K: - буква диска.
        <br>
        K:\10 - создать ISO-образ из файлов и папок, находящихся на разделе K: в папке 10
        K:\Windows.iso - созданный образ Win 10 разместить на разделе K:.
        присвоить имя образу Win 10 - Windows.
        <br>
        Дистрибутив Windows.iso на флешке (K:) готов.
        <br><br>
        Создание загрузочной флешки
        Предлагаю создать загрузочную флешку Windows 10 программой
        WinSetupFromUSB, с помощью неё можно создать универсальную флешку, с помощью
        которой получится установить Windows 10 на новый ноутбук с БИОСом UEFI, а также на
        простой компьютер с обычным БИОС. Подробно на этом останавливаться мне бы не
        хотелось, всё очень хорошо описано в этой статье.
        Установка Windows 10
        Процесс установки собственного дистрибутива Windows 10 ничем не отличается от
        обычного процесса установки описанного в этой статье. Установить такую сборку вы
        можете на любой компьютер. Когда Windows 10 установится, то все программы будут
        тоже установлены.
    </h7>

    <div class="button-back-page">
        <a class="div-frame" href="/source/html/second.html" />
    </div>

    <h7 class="xh1"></h7>
</body></html>
